{% extends "base2.html" %}

{% block title %}
Planora - Create New Event
{% endblock %}

{% block body %}
<div class="container mx-auto px-4 py-8 max-w-2xl">
    <h1 class="text-3xl font-bold text-foreground mb-6">Create New Event</h1>
    <form method="POST" enctype="multipart/form-data" class="space-y-6">
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        {% for message in messages %}
        <div class="bg-destructive text-destructive-foreground p-3 rounded-md text-sm" role="alert">
            {{ message }}
        </div>
        {% endfor %}
        {% endif %}
        {% endwith %}

        <div>
            <label for="event-title" class="block text-sm font-medium text-foreground mb-1">Event Title</label>
            <input type="text" id="event-title" name="title"
                class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 text-foreground"
                required value="{{ request.form.title or '' }}">
        </div>

        <div>
            <label for="description" class="block text-sm font-medium text-foreground mb-1">Event Description</label>
            <textarea id="description" name="description" rows="5"
                class="flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 text-foreground"
                required>{{ request.form.description or '' }}</textarea>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <label for="date" class="block text-sm font-medium text-foreground mb-1">Date</label>
                <input id="date" name="date" type="date"
                    class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 text-foreground"
                    required value="{{ request.form.date or '' }}">
            </div>
            <div>
                <label for="location" class="block text-sm font-medium text-foreground mb-1">Location</label>
                <input type="text" id="location" name="location"
                    class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 text-foreground"
                    value="{{ request.form.location or '' }}">
            </div>
        </div>

        <div>
            <label for="ticket-price" class="block text-sm font-medium text-foreground mb-1">Ticket Price</label>
            <input type="number" id="ticket-price" name="price" placeholder="0.00" step="0.01" min="0"
                class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 text-foreground"
                required value="{{ request.form.price or '' }}">
        </div>

        <div>
            <label for="tickets-available" class="block text-sm font-medium text-foreground mb-1">Tickets
                Available</label>
            <input type="number" id="tickets-available" name="tickets_available" placeholder="e.g., 100" min="0"
                class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 text-foreground"
                required value="{{ request.form.tickets_available or '' }}">
        </div>

        <div>
            <label class="block text-sm font-medium text-foreground mb-1">Upload Banner Image</label>
            <input type="file" name="image" id="upload" class="sr-only" required accept="image/*">
            <label for="upload"
                class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 cursor-pointer bg-secondary text-secondary-foreground hover:bg-muted/80">
                Choose Image
            </label>
            <span id="file-name" class="ml-2 text-sm text-muted-foreground">No file chosen</span>
        </div>

        <button type="submit"
            class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 bg-primary text-primary-foreground hover:bg-primary/90 w-full">
            Create Event
        </button>
    </form>

    <script>
        const fileInput = document.getElementById('upload');
        const fileNameSpan = document.getElementById('file-name');
        const uploadLabel = document.querySelector('label[for="upload"]'); // Get the label itself

        fileInput.addEventListener('change', () => {
            if (fileInput.files.length > 0) {
                fileNameSpan.textContent = fileInput.files[0].name;
            } else {
                fileNameSpan.textContent = 'No file chosen';
            }
        });
        if (fileInput.files.length > 0) {
            fileNameSpan.textContent = fileInput.files[0].name;
        }
    </script>
</div>
{% endblock %}